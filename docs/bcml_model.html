---

title: bcml_model


keywords: fastai
sidebar: home_sidebar

summary: "Core class representing a binary classification (BC) machine learning (ML) model"
description: "Core class representing a binary classification (BC) machine learning (ML) model"
nb_path: "bcml_model.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: bcml_model.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="bcml_model" class="doc_header"><code>class</code> <code>bcml_model</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L14" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>bcml_model</code>(<strong><code>model</code></strong>, <strong><code>train</code></strong>, <strong><code>test</code></strong>, <strong><code>num_bgs</code></strong>=<em><code>3</code></em>)</p>
</blockquote>
<p>Represents a machine learning (ML) binary classification (BC) model.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Getting-up-and-running">Getting up and running<a class="anchor-link" href="#Getting-up-and-running"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Creating-a-bcml_model-instance">Creating a <a href="/bcml4pheno/bcml_model.html#bcml_model"><code>bcml_model</code></a> instance<a class="anchor-link" href="#Creating-a-bcml_model-instance"> </a></h4><p>To create a new <a href="/bcml4pheno/bcml_model.html#bcml_model"><code>bcml_model</code></a> instance, three things are required.</p>
<p>First, you need <code>model</code>, a machine learning binary classification model: this library was designed to work with <code>scikit-learn</code> classifiers, such as <code>sklearn.linear_model.LogisticRegression</code>, <code>sklearn.ensemble.RandomForestClassifier</code>, or <code>sklearn.ensemble.GradientBoostingClassifier</code>.</p>
<p>Second, you need <code>train</code>, a training data set. This should be a <code>numpy</code> array of shape $N \times (M + 1)$ if you have $N$ training data points and $M$ features. The first $M$ columns of <code>train</code> should contain your features, while the final column is your label: $1$ denotes signal, while $0$ or a strictly negative integer denotes background. Negative integers can be used to denote different kinds of background: i.e., $-2$ would denote the background of type $2$.</p>
<p>Third, you need <code>test</code>, a testing data set. This should be a <code>numpy</code> array of shape $N' \times (M + 1)$ formatted the same as <code>train</code>. Typically, $N' \approx \frac{1}{3}N$.</p>
<p>If you utilize the negative integer labelling of background data points, you should pass <code>num_bgs</code> as well, denoting the number of different backgrounds you're using (i.e., your backgrounds labels $\ell_i$ satisfy $-$ <code>num_bgs</code> $\leq \ell_i \leq -1$).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Attributes-of-bcml_model">Attributes of <a href="/bcml4pheno/bcml_model.html#bcml_model"><code>bcml_model</code></a><a class="anchor-link" href="#Attributes-of-bcml_model"> </a></h4><p>In addition to the arguments passed, a <a href="/bcml4pheno/bcml_model.html#bcml_model"><code>bcml_model</code></a> instance has the following attributes.</p>
<p><code>train_preds</code>: training predictors, $N \times M$ <code>numpy</code> array, the first $M$ columns of train.</p>
<p><code>train_labels</code>: training labels, <code>numpy</code> array of length $N$, final column of train (with negative integers mapped to $0$)</p>
<p><code>test_preds</code>: test predictors, $N' \times M$ <code>numpy</code> array, first $M$ columns of test</p>
<p><code>test_labels</code>: test labels, <code>numpy</code> array of length $N'$, final column of test (with negative integers mapped to $0$)</p>
<p><code>test_bgs</code>: background test data split by background, list of $N_i \times (M + 1)$ <code>numpy</code> arrays such that the $i$th element contains all test data points of background type $i$ (i.e., $1 \leq i \leq$ <code>num_bgs</code> and $\sum_i N_i = N' - $ # of signal data points)</p>
<p><code>test_bgs_preds</code>: background test predictors split by background, list of $N_i \times M$ <code>numpy</code> arrays</p>
<p><code>test_sigs</code>: signal test data, $\overline{N} \times (M + 1)$ <code>numpy</code> array (i.e., $\overline{N} + \sum_i N_i = N'$)</p>
<p><code>test_sigs_preds</code>: signal test data predictors, $\overline{N} \times M$ <code>numpy</code> array</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Basic-Functionality">Basic Functionality<a class="anchor-link" href="#Basic-Functionality"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.fit" class="doc_header"><code>bcml_model.fit</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L33" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.fit</code>(<strong><code>preds</code></strong>=<em><code>None</code></em>, <strong><code>labels</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Fits <code>model</code> to data.</p>
<p>If predictors <code>preds</code> and labels <code>labels</code> aren't provided,
<code>self.train_preds</code> and <code>self.train_labels</code> are used, respectively.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.predict_proba" class="doc_header"><code>bcml_model.predict_proba</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L44" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.predict_proba</code>(<strong><code>preds</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Predicts signal probability for each element of a dataset ($? \times M$ <code>numpy</code> array).</p>
<p>Returns <code>numpy</code> array of length $M$ with values in $[0,1]$ giving predicted signal probabilities.</p>
<p>If predictors <code>preds</code> aren't provided, <code>self.test_preds</code> is used.
Uses the <code>predict_proba</code> method built into <code>scikit-learn</code> models.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.predict" class="doc_header"><code>bcml_model.predict</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L59" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.predict</code>(<strong><code>preds</code></strong>=<em><code>None</code></em>, <strong><code>threshold</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Predicts signal ($1$) or background ($2$) for each element of a dataset ($?     imes M$ <code>numpy</code> array).</p>
<p>Returns <code>numpy</code> array of length $M$ with values in $\{0,1\}$ giving predicted classifications.</p>
<p>If predictors <code>preds</code> aren't provided, <code>self.test_preds</code> is used.
Uses the <code>predict</code> method built into <code>scikit-learn</code> models.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.predict_hist" class="doc_header"><code>bcml_model.predict_hist</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L78" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.predict_hist</code>(<strong><code>preds</code></strong>=<em><code>None</code></em>, <strong><code>labels</code></strong>=<em><code>None</code></em>, <strong><code>num_bins</code></strong>=<em><code>100</code></em>, <strong><code>sepbg</code></strong>=<em><code>False</code></em>, <strong><code>sig_norm</code></strong>=<em><code>1</code></em>, <strong><code>bg_norm</code></strong>=<em><code>1</code></em>, <strong><code>dataframe</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Constructs a histogram of predicted signal probabilities for signal and background constituents of
a dataset ($? \times M$ <code>numpy</code> array).</p>
<p>If <code>sepbg</code> is <code>False</code> (the default), background is combined and a list of $3$ $?_i \times M$ <code>numpy</code> arrays are returned,
containing bin edges (partitioning $[0,1]$), signal bin contents, and background bin contents.</p>
<p>If <code>sepbg</code> is <code>True</code>, backgrounds are differentiated list of $2 +$ <code>num_bgs</code> $?_i \times M$ <code>numpy</code> arrays are returned,
containing bin edges (partitioning $[0,1]$), signal bin contents, and <code>self.num_bgs</code> background bin contents.</p>
<p>If predictors <code>preds</code> aren't provided, <code>self.test_preds</code> is used.
If <code>labels</code> aren't provided, <code>self.test_labels</code> is used.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.feature_importance" class="doc_header"><code>bcml_model.feature_importance</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L114" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.feature_importance</code>()</p>
</blockquote>
<p>Returns the importance of the $M$ features used to train <code>self.model</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.sorted_feature_importance" class="doc_header"><code>bcml_model.sorted_feature_importance</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L126" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.sorted_feature_importance</code>(<strong><code>features</code></strong>)</p>
</blockquote>
<p>Returns list of features sorted by importance.</p>
<p>Given arguments <code>features</code> and <code>importances</code>, lists of length $M$, returns list of size $M      imes 2$ where
the first column gives features and the second their associated importances, sorted by importance.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.accuracy" class="doc_header"><code>bcml_model.accuracy</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L137" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.accuracy</code>(<strong><code>preds</code></strong>=<em><code>None</code></em>, <strong><code>labels</code></strong>=<em><code>None</code></em>, <strong><code>threshold</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Computes model accuracy on a dataset ($? x M$ predictors, length $?$ labels).</p>
<p>Returns value in $[0,1]$ giving model accuracy on the provided predictors and labels.</p>
<p>If predictors <code>preds</code> aren't provided, <code>self.test_preds</code> is used.
If <code>labels</code> aren't provided, <code>self.test_labels</code> is used.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.conf_matrix" class="doc_header"><code>bcml_model.conf_matrix</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L151" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.conf_matrix</code>(<strong><code>predictions</code></strong>=<em><code>None</code></em>, <strong><code>labels</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Computes the confusion matrix of the trained model on a dataset ($? x M$ predictors, length $?$ labels).</p>
<p>Returns $2 \times 2$ confusion matrix using <code>sklearn.metrics.confusion_matrix</code>.</p>
<p>If predictors <code>preds</code> aren't provided, <code>self.test_preds</code> is used.
If <code>labels</code> aren't provided, <code>self.test_labels</code> is used.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.tpr_cm" class="doc_header"><code>bcml_model.tpr_cm</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L164" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.tpr_cm</code>(<strong><code>conf_matrix</code></strong>)</p>
</blockquote>
<p>Computes the true positive rate (tpr; correctly identified signal/total signal)
of a trained model given a confusion matrix.</p>
<p>Returns value in $[0,1]$.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.fpr_cm" class="doc_header"><code>bcml_model.fpr_cm</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L173" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.fpr_cm</code>(<strong><code>conf_matrix</code></strong>)</p>
</blockquote>
<p>Computes the false positive rate (fpr; misidentified background/total background)
of a trained model given a confusion matrix.</p>
<p>Returns value in $[0,1]$.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.tpr" class="doc_header"><code>bcml_model.tpr</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L182" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.tpr</code>(<strong><code>predictions</code></strong>=<em><code>None</code></em>, <strong><code>labels</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Computes the true positive rate (tpr; correctly identified signal/total signal)
of a trained model given predictions and labels (both <code>numpy</code> array of length $?$ with values in $\{0,1\}$)</p>
<p>Returns value in $[0,1]$.</p>
<p>If <code>predictions</code> aren't provided, <code>self.predict(self.test_preds)</code> is used.
If <code>labels</code> aren't provided, <code>self.test_labels</code> is used.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.fpr" class="doc_header"><code>bcml_model.fpr</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L196" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.fpr</code>(<strong><code>predictions</code></strong>=<em><code>None</code></em>, <strong><code>labels</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Computes the false positive rate (fpr; misidentified background/total background)
of a trained model given predictions and labels (both <code>numpy</code> array of length $?$ with values in $\{0,1\}$)</p>
<p>Returns value in $[0,1]$.</p>
<p>If <code>predictions</code> aren't provided, <code>self.predict(self.test_preds)</code> is used.
If <code>labels</code> aren't provided, <code>self.test_labels</code> is used.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Phenomenology">Phenomenology<a class="anchor-link" href="#Phenomenology"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.significance" class="doc_header"><code>bcml_model.significance</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L210" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.significance</code>(<strong><code>signal</code></strong>, <strong><code>background</code></strong>, <strong><code>tpr</code></strong>=<em><code>None</code></em>, <strong><code>fpr</code></strong>=<em><code>None</code></em>, <strong><code>sepbg</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Computes signal significance of a trained model given signal and background yield.</p>
<p>Returns a positive real number computed by
$$\frac{S \cdot TPR}{\sqrt{S \cdot TPR + B \cdot FPR}}$$
which corresponds to signal significance after selecting only datapoints the model identifies as signal.</p>
<p>If <code>sepbg</code> is <code>False</code>, <code>background</code> should be a single real number and is multiplied by <code>fpr</code>. If <code>sepbg</code> is <code>True</code>,
<code>background</code> should be a list of length <code>self.num_bgs</code> where the $i$th element contains background yield of the $i$th
background type. <code>fpr</code>, if passed, is then also a list of length <code>self.num_bgs</code> giving false positive rates for each
of the background types.</p>
<p>If <code>tpr</code> isn't provided, <code>self.tpr()</code> is used.
If <code>fpr</code> isn't provided, <code>self.fpr()</code> or a list of false positive rates coming from <code>self.test_bgs</code>
are used, depending on the value of <code>sepbg</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.newvar2thresh" class="doc_header"><code>bcml_model.newvar2thresh</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L238" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.newvar2thresh</code>(<strong><code>newvar</code></strong>)</p>
</blockquote>
<p>Helper method for <code>bcml.max_allowable_threshold()</code>, <code>bcml.get_tprs_fprs()</code>, and <code>bcml.best_threshold()</code>,
performing change of variables from <code>newvar</code> to <code>threshold</code></p>
<p>In particular, threshold $= 1 - 10^{\text{newvar}}$</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.thresh2newvar" class="doc_header"><code>bcml_model.thresh2newvar</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L248" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.thresh2newvar</code>(<strong><code>thresh</code></strong>)</p>
</blockquote>
<p>Helper method for <code>bcml.max_allowable_threshold()</code>, <code>bcml.get_tprs_fprs()</code>, and <code>bcml.best_threshold()</code>,
performing change of variables from <code>threshold</code> to <code>newvar</code></p>
<p>In particular, newvar $= \log_{10}(1 - \text{threhold})$</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.max_allowable_threshold" class="doc_header"><code>bcml_model.max_allowable_threshold</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L258" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.max_allowable_threshold</code>(<strong><code>preds</code></strong>=<em><code>None</code></em>, <strong><code>labels</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Returns the highest threshold such that only labelling elements of <code>self.test_pred</code> with predicted
probabilities higher than that threshold as signal still yields 25 signal.</p>
<p>To achieve a discovery potential of $5\sigma$, even in the best case scenario ($TPR = 1, FPR = 0$) we still
require $5^2 = 25$ signal events, hence we cannot chose a threshold so high that we do not keep at least
25 signal events.</p>
<p>If predictors <code>preds</code> aren't provided, <code>self.test_preds</code> is used.
If <code>labels</code> aren't provided, <code>self.test_labels</code> is used.</p>
<p>NOTE: this function frequently returns an extrapolation error as $25$ frequently falls outside of the
function interpolation range (i.e., to achieve less than 25 signal events requires coming extremely close to $1$).</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.get_tprs_fprs" class="doc_header"><code>bcml_model.get_tprs_fprs</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L285" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.get_tprs_fprs</code>(<strong><code>preds</code></strong>=<em><code>None</code></em>, <strong><code>labels</code></strong>=<em><code>None</code></em>, <strong><code>sepbg</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Produces (true positive rate, false positive rate) pairs for various thresholds
for the trained model on data sets.</p>
<p>If <code>sepbg</code> is <code>True</code>, background is combined and a list of length $4$ is returned containing a list of $L$ sampled
newvars (a convenient change of variable to approach arbitrarily close to 1: related to thresholds by
<a href="/bcml4pheno/bcml_model.html#bcml_model.newvar2thresh("><code>bcml_model.newvar2thresh()</code></a>)), an $L$-list of tprs associated to those thresholds, an $L$-list of fprs
related to those thresholds, and an $L$-list of length $?$ <code>numpy</code> arrays giving the predicted signal probabilities
for the given data set.</p>
<p>If <code>sepbg</code> is <code>Frue</code>, background is split and a list of length $4$ <code>self.num_bgs</code> is returned containing a
list of $L$ sampled newvars, an $L$-list of tprs associated to those thresholds, an $L$-list of lists of length
<code>self.num_bgs</code> containing fprs for each background type for each threshold, and an $L$-list of length $?$
<code>numpy</code> arrays giving the predicted signal probabilities for the given data set.</p>
<p>If predictors <code>preds</code> aren't provided, <code>self.test_preds</code> is used.
If <code>labels</code> aren't provided, <code>self.test_labels</code> is used.
Changes are made to both of the above depending on the value of <code>sepbg</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.best_threshold" class="doc_header"><code>bcml_model.best_threshold</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L337" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.best_threshold</code>(<strong><code>signal</code></strong>, <strong><code>background</code></strong>, <strong><code>preds</code></strong>=<em><code>None</code></em>, <strong><code>labels</code></strong>=<em><code>None</code></em>, <strong><code>sepbg</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Optimizes the threshold on a given data set ($? x M$ predictors, length $?$ labels).</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.req_sig_cs" class="doc_header"><code>bcml_model.req_sig_cs</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L372" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.req_sig_cs</code>(<strong><code>lumi</code></strong>, <strong><code>bg_cs</code></strong>, <strong><code>tpr</code></strong>, <strong><code>fpr</code></strong>, <strong><code>sig</code></strong>=<em><code>5</code></em>, <strong><code>sepbg</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Given a luminosity (in fb$^{-1}$), a background cross section (in pb), a true positive rate, a false positive rate,
and a signal significance, computes the signal cross section required for the signal significance to be achieved.</p>
<p>If <code>sepbg</code> is False, background is combined and a single FPR is used; if <code>sepbg</code> is True, it is assumed that
<code>bg_cs</code>, <code>fpr</code> are each lists of length <code>self.num_bgs</code> and their vector dot product is used for background yield.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Other-utilities">Other utilities<a class="anchor-link" href="#Other-utilities"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.save_model" class="doc_header"><code>bcml_model.save_model</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L389" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.save_model</code>(<strong><code>filename</code></strong>)</p>
</blockquote>
<p>Saves the model to <code>filename.joblib</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="refresh_model" class="doc_header"><code>refresh_model</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L396" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>refresh_model</code>(<strong><code>model</code></strong>)</p>
</blockquote>
<p>If this class gets updated, run this function on your already trained model to have it reflect the updated
class without retraining being necessary.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

