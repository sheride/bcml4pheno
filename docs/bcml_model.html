---

title: bcml_model


keywords: fastai
sidebar: home_sidebar

summary: "Core class representing a binary classification (BC) machine learning (ML) model"
description: "Core class representing a binary classification (BC) machine learning (ML) model"
nb_path: "bcml_model.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: bcml_model.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="bcml_model" class="doc_header"><code>class</code> <code>bcml_model</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L14" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>bcml_model</code>(<strong><code>model</code></strong>)</p>
</blockquote>
<p>Represents a machine learning (ML) binary classification (BC) model.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Getting-up-and-running">Getting up and running<a class="anchor-link" href="#Getting-up-and-running"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Creating-a-bcml_model-instance">Creating a <a href="/bcml4pheno/bcml_model.html#bcml_model"><code>bcml_model</code></a> instance<a class="anchor-link" href="#Creating-a-bcml_model-instance"> </a></h4><p>To create a new <a href="/bcml4pheno/bcml_model.html#bcml_model"><code>bcml_model</code></a> instance, all you need to pass is a <code>model</code>, a machine learning binary classification model. This library was designed to work with <code>scikit-learn</code> classifiers, such as <code>sklearn.linear_model.LogisticRegression</code>, <code>sklearn.ensemble.RandomForestClassifier</code>, or <code>sklearn.ensemble.GradientBoostingClassifier</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Basic-Functionality">Basic Functionality<a class="anchor-link" href="#Basic-Functionality"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.fit" class="doc_header"><code>bcml_model.fit</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L34" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.fit</code>(<strong><code>preds</code></strong>, <strong><code>labels</code></strong>)</p>
</blockquote>
<p>Fits <code>model</code> to data.</p>
<p><code>preds</code> should be ? $\times$ $m$ for model with $m$ features. <code>labels</code> should
be ? $\times$ 1 and take values in $\{0,1\}$.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.predict_proba" class="doc_header"><code>bcml_model.predict_proba</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L43" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.predict_proba</code>(<strong><code>preds</code></strong>)</p>
</blockquote>
<p>Predicts signal probability for each element of a dataset ($? \times m$ <code>numpy</code> array).</p>
<p>Returns <code>numpy</code> array of with values in $[0,1]$ giving predicted signal probabilities for
each data point.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.predict" class="doc_header"><code>bcml_model.predict</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L55" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.predict</code>(<strong><code>preds</code></strong>, <strong><code>threshold</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Predicts signal ($1$) or background ($0$) for each element of a dataset ($? \times m$ <code>numpy</code> array).</p>
<p>Returns <code>numpy</code> array of length with values in $\{0,1\}$ giving predicted classifications.</p>
<p>Uses the <code>predict</code> method built into <code>scikit-learn</code> models.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.predict_hist" class="doc_header"><code>bcml_model.predict_hist</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L72" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.predict_hist</code>(<strong><code>preds</code></strong>, <strong><code>labels</code></strong>, <strong><code>num_bins</code></strong>=<em><code>100</code></em>, <strong><code>sepbg</code></strong>=<em><code>False</code></em>, <strong><code>sig_norm</code></strong>=<em><code>1</code></em>, <strong><code>bg_norm</code></strong>=<em><code>1</code></em>, <strong><code>dataframe</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Constructs a histogram of predicted signal probabilities for signal and background constituents of
a dataset ($? \times M$ <code>numpy</code> array).</p>
<p>If <code>sepbg</code> is <code>False</code> (the default), labels are assumed to take values in $\{0,1\}$. Backgrounds are treated in combination:
a list of $3$ $?_i \times m$ <code>numpy</code> arrays are returned, containing bin edges (partitioning $[0,1]$),
signal bin contents, and background bin contents.</p>
<p>If <code>sepbg</code> is <code>True</code>, labels are assumed to take values in $\{-n,\dots,-1,1\}$ (if there are $n$ backgrounds) while
<code>bg_norm</code> should be a list of length $n$. Backgrounds are then differentiated: a list of $2 + n$ <code>numpy</code> arrays of shape
$?_i \times m$ are returned, containing bin edges (partitioning $[0,1]$), signal bin contents, and
<code>self.num_bgs</code> background bin contents.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.feature_importance" class="doc_header"><code>bcml_model.feature_importance</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L105" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.feature_importance</code>()</p>
</blockquote>
<p>Returns the importance of the $M$ features used to train <code>self.model</code>.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.sorted_feature_importance" class="doc_header"><code>bcml_model.sorted_feature_importance</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L117" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.sorted_feature_importance</code>(<strong><code>features</code></strong>)</p>
</blockquote>
<p>Returns list of features sorted by importance.</p>
<p>Given arguments <code>features</code> and <code>importances</code>, lists of length $M$, returns list of size $M \times 2$ where
the first column gives features and the second their associated importances, sorted by importance.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.accuracy" class="doc_header"><code>bcml_model.accuracy</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L128" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.accuracy</code>(<strong><code>preds</code></strong>, <strong><code>labels</code></strong>, <strong><code>threshold</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Computes model accuracy on a dataset ($? x m$ predictors, length $?$ labels).</p>
<p>Returns value in $[0,1]$ giving model accuracy on the provided predictors and labels.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.conf_matrix" class="doc_header"><code>bcml_model.conf_matrix</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L137" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.conf_matrix</code>(<strong><code>labels</code></strong>, <strong><code>predictions</code></strong>=<em><code>None</code></em>, <strong><code>preds</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Computes the confusion matrix of the trained model on a dataset ($? x M$ predictors, length $?$ labels).</p>
<p>Returns $2 \times 2$ confusion matrix using <code>sklearn.metrics.confusion_matrix</code>.</p>
<p>If predictors <code>preds</code> aren't provided, <code>self.test_preds</code> is used.
If <code>labels</code> aren't provided, <code>self.test_labels</code> is used.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.tpr_cm" class="doc_header"><code>bcml_model.tpr_cm</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L154" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.tpr_cm</code>(<strong><code>conf_matrix</code></strong>)</p>
</blockquote>
<p>Computes the true positive rate (tpr; correctly identified signal/total signal)
of a trained model given a confusion matrix.</p>
<p>Returns value in $[0,1]$.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.fpr_cm" class="doc_header"><code>bcml_model.fpr_cm</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L163" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.fpr_cm</code>(<strong><code>conf_matrix</code></strong>)</p>
</blockquote>
<p>Computes the false positive rate (fpr; misidentified background/total background)
of a trained model given a confusion matrix.</p>
<p>Returns value in $[0,1]$.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.tpr" class="doc_header"><code>bcml_model.tpr</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L172" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.tpr</code>(<strong><code>labels</code></strong>, <strong><code>predictions</code></strong>=<em><code>None</code></em>, <strong><code>preds</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Computes the true positive rate (tpr; correctly identified signal/total signal)
of a trained model given predictions and labels (both <code>numpy</code> array of length $?$ with values in $\{0,1\}$)</p>
<p>Returns value in $[0,1]$.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.fpr" class="doc_header"><code>bcml_model.fpr</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L181" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.fpr</code>(<strong><code>labels</code></strong>, <strong><code>predictions</code></strong>=<em><code>None</code></em>, <strong><code>preds</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Computes the false positive rate (fpr; misidentified background/total background)
of a trained model given predictions and labels (both <code>numpy</code> array of length $?$ with values in $\{0,1\}$)</p>
<p>Returns value in $[0,1]$.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Phenomenology">Phenomenology<a class="anchor-link" href="#Phenomenology"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.significance" class="doc_header"><code>bcml_model.significance</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L190" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.significance</code>(<strong><code>signal</code></strong>, <strong><code>background</code></strong>, <strong><code>tpr</code></strong>, <strong><code>fpr</code></strong>, <strong><code>sepbg</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Computes signal significance of a trained model given signal and background yield.</p>
<p>Returns a positive real number computed by
$$\frac{S \cdot TPR}{\sqrt{S \cdot TPR + B \cdot FPR}}$$
which corresponds to signal significance after selecting only datapoints the model identifies as signal.</p>
<p>If <code>sepbg</code> is <code>False</code>, <code>background</code> should be a single real number and is multiplied by <code>fpr</code>. If <code>sepbg</code> is <code>True</code>,
<code>background</code> should be a list of length <code>self.num_bgs</code> where the $i$th element contains background yield of the $i$th
background type. <code>fpr</code>, if passed, is then also a list of length <code>self.num_bgs</code> giving false positive rates for each
of the background types.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.newvar2thresh" class="doc_header"><code>bcml_model.newvar2thresh</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L211" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.newvar2thresh</code>(<strong><code>newvar</code></strong>)</p>
</blockquote>
<p>Helper method for <code>bcml.max_allowable_threshold()</code>, <code>bcml.get_tprs_fprs()</code>, and <code>bcml.best_threshold()</code>,
performing change of variables from <code>newvar</code> to <code>threshold</code></p>
<p>In particular, threshold $= 1 - 10^{\text{newvar}}$</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.thresh2newvar" class="doc_header"><code>bcml_model.thresh2newvar</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L220" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.thresh2newvar</code>(<strong><code>thresh</code></strong>)</p>
</blockquote>
<p>Helper method for <code>bcml.max_allowable_threshold()</code>, <code>bcml.get_tprs_fprs()</code>, and <code>bcml.best_threshold()</code>,
performing change of variables from <code>threshold</code> to <code>newvar</code></p>
<p>In particular, newvar $= \log_{10}(1 - \text{threhold})$</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.max_allowable_threshold" class="doc_header"><code>bcml_model.max_allowable_threshold</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L229" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.max_allowable_threshold</code>(<strong><code>preds</code></strong>, <strong><code>labels</code></strong>)</p>
</blockquote>
<p>Returns the highest threshold such that only labelling elements of <code>self.test_pred</code> with predicted
probabilities higher than that threshold as signal still yields 25 signal.</p>
<p>To achieve a discovery potential of $5\sigma$, even in the best case scenario ($TPR = 1, FPR = 0$) we still
require $5^2 = 25$ signal events, hence we cannot chose a threshold so high that we do not keep at least
25 signal events.</p>
<p>NOTE: this function frequently returns an extrapolation error as $25$ frequently falls outside of the
function interpolation range (i.e., to achieve less than 25 signal events requires coming extremely close to $1$).</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.get_tprs_fprs" class="doc_header"><code>bcml_model.get_tprs_fprs</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L250" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.get_tprs_fprs</code>(<strong><code>preds</code></strong>, <strong><code>labels</code></strong>, <strong><code>sepbg</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Produces (true positive rate, false positive rate) pairs for various thresholds
for the trained model on data sets.</p>
<p>If <code>sepbg</code> is <code>True</code>, labels should take values in $\{-n,\dots,-1,1\}$. Background is combined and a list of length $4$
is returned containing a list of $L$ sampled newvars (a convenient change of variable to approach arbitrarily close to 1:
related to thresholds by  <a href="/bcml4pheno/bcml_model.html#bcml_model.newvar2thresh("><code>bcml_model.newvar2thresh()</code></a>)), an $L$-list of tprs associated to those thresholds, an $L$-list of fprs
related to those thresholds, and an $L$-list of length $?$ <code>numpy</code> arrays giving the predicted signal probabilities
for the given data set.</p>
<p>If <code>sepbg</code> is <code>Frue</code>, labels should take values in $\{0,1\}$. Background is split and a list of length $4$ <code>self.num_bgs</code>
is returned containing a  list of $L$ sampled newvars, an $L$-list of tprs associated to those thresholds, an $L$-list of lists of length
$n$ (number of backgrounds) containing fprs for each background type for each threshold, and an $L$-list of length $?$</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.best_threshold" class="doc_header"><code>bcml_model.best_threshold</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L300" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.best_threshold</code>(<strong><code>signal</code></strong>, <strong><code>background</code></strong>, <strong><code>preds</code></strong>, <strong><code>labels</code></strong>, <strong><code>sepbg</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Optimizes the threshold on a given data set ($? x M$ predictors, length $?$ labels).</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.req_sig_cs" class="doc_header"><code>bcml_model.req_sig_cs</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L335" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.req_sig_cs</code>(<strong><code>lumi</code></strong>, <strong><code>bg_cs</code></strong>, <strong><code>tpr</code></strong>, <strong><code>fpr</code></strong>, <strong><code>sig</code></strong>=<em><code>5</code></em>, <strong><code>sepbg</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Given a luminosity (in fb$^{-1}$), a background cross section (in pb), a true positive rate, a false positive rate,
and a signal significance, computes the signal cross section required for the signal significance to be achieved.</p>
<p>If <code>sepbg</code> is False, background is combined and a single FPR is used; if <code>sepbg</code> is True, it is assumed that
<code>bg_cs</code>, <code>fpr</code> are each lists of length $n$ (number of backgrounds) and their vector dot product is used for background yield.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The formula used by <code>req_sig_cs</code> arises as follows.</p>
<p>We know that
{% raw %}
$$\mathcal{S} = \frac{S \cdot \text{TPR}}{\sqrt{S \cdot \text{TPR} + B \cdot \text{FPR}}} = \frac{\mathcal{L} \cdot \sigma_s \cdot \text{TPR}}{\sqrt{\mathcal{L} \cdot \sigma_s \cdot \text{TPR} + \mathcal{L} \cdot \sigma_s \cdot \text{FPR}}}$$
{% endraw %}
We can work toward solving for $\sigma_s$ as follows.
\begin{align}
    \mathcal{S} &amp;= \frac{\mathcal{L} \cdot \sigma_s \cdot \text{TPR}}{\sqrt{\mathcal{L} \cdot \sigma_s \cdot \text{TPR} + \mathcal{L} \cdot \sigma_b \cdot \text{FPR}}} \\
    \mathcal{S} \left(\sqrt{\mathcal{L} \cdot \sigma_s \cdot \text{TPR} + \mathcal{L} \cdot \sigma_b \cdot \text{FPR}}\right)&amp;= \mathcal{L} \cdot \sigma_s \cdot \text{TPR} \\
    \mathcal{S}^2 \left(\sigma_s \cdot \text{TPR} + \sigma_b \cdot \text{FPR}\right) &amp;= \mathcal{L} \cdot \sigma_s^2 \cdot \text{TPR}^2 \\
    0 &amp;= -\left(\mathcal{L} \cdot \text{TPR}^2\right)\sigma_s^2 + \left(\mathcal{S}^2 \cdot \text{TPR}\right)\sigma_s + \left(\mathcal{S}^2 \cdot \sigma_b \cdot \text{FPR}\right)
\end{align}
This is then easily solvable using the quadratic formula.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Other-utilities">Other utilities<a class="anchor-link" href="#Other-utilities"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="bcml_model.save_model" class="doc_header"><code>bcml_model.save_model</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L351" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>bcml_model.save_model</code>(<strong><code>filename</code></strong>)</p>
</blockquote>
<p>Saves the model to <code>filename.joblib</code></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="refresh_model" class="doc_header"><code>refresh_model</code><a href="https://github.com/sheride/bcml4pheno/tree/master/bcml4pheno/bcml_model.py#L358" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>refresh_model</code>(<strong><code>model</code></strong>)</p>
</blockquote>
<p>If this class gets updated, run this function on your already trained model to have it reflect the updated
class without retraining being necessary.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

